"use strict";(self.webpackChunkRepainters=self.webpackChunkRepainters||[]).push([[780],{2780:(ut,d,i)=>{i.r(d),i.d(d,{QuotationBuilderModule:()=>mt});var c=i(177),m=i(9417),u=i(7062),t=i(7705),g=i(65),h=i(4651),p=i(6850),b=i(4028),v=i(891),C=i(3158),T=i(8780),y=i(1060),x=i(631),I=i(2569),M=i(8711),F=i(7161),D=i(517),N=i(9271),f=i(8834);const G=["tabGroup"];function P(e,r){1&e&&(t.j41(0,"span",21),t.EFF(1,"\u{1f589}"),t.k0s())}function V(e,r){if(1&e&&(t.EFF(0),t.DNE(1,P,2,0,"span",20)),2&e){const n=t.XpG(2);t.SpI(" ",n.getTabLabel("Package","package").label," "),t.R7$(1),t.Y8G("ngIf",n.getTabLabel("Package","package").modified)}}function w(e,r){if(1&e){const n=t.RV6();t.j41(0,"app-dashboard",22),t.bIt("formModified",function(){t.eBV(n);const a=t.XpG(2);return t.Njj(a.onPackageModified())}),t.k0s()}}function j(e,r){1&e&&(t.j41(0,"mat-tab"),t.DNE(1,V,2,2,"ng-template",9),t.DNE(2,w,1,0,"ng-template",10),t.k0s())}function B(e,r){1&e&&(t.j41(0,"span",21),t.EFF(1,"\u25cf"),t.k0s())}function k(e,r){if(1&e&&(t.EFF(0),t.DNE(1,B,2,0,"span",20)),2&e){const n=t.XpG();t.SpI(" ",n.getTabLabel("Internal Painting","internalPainting").label," "),t.R7$(1),t.Y8G("ngIf",n.getTabLabel("Internal Painting","internalPainting").modified)}}function S(e,r){if(1&e){const n=t.RV6();t.j41(0,"app-requirement",23),t.bIt("formModified",function(){t.eBV(n);const a=t.XpG();return t.Njj(a.onTabModified("internalPainting"))}),t.k0s()}}function E(e,r){1&e&&t.nrm(0,"app-wallpaper",24)}function L(e,r){1&e&&t.nrm(0,"app-texture-painting",25)}function R(e,r){1&e&&t.nrm(0,"app-paneling",26)}function $(e,r){1&e&&t.nrm(0,"app-curtains",27)}function X(e,r){1&e&&t.nrm(0,"app-furniture",28)}function U(e,r){1&e&&t.nrm(0,"app-services",29)}function O(e,r){1&e&&t.nrm(0,"app-door-grills",30)}function A(e,r){1&e&&t.nrm(0,"app-summary")}function Q(e,r){1&e&&t.nrm(0,"app-note",31)}const Y=function(e){return{"background-color":e}},_=[{path:"",component:(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-quotation-builder"]],decls:1,vars:0,template:function(o,a){1&o&&t.nrm(0,"router-outlet")},dependencies:[u.n3]})}}return e})(),children:[{path:"view/:customerId",component:(()=>{class e{handleKeyDown(n){if("d"===n.key.toLowerCase()&&n.shiftKey){n.preventDefault();const o=this.getTabIndex("summary");-1!==o&&this.navigateToTab(o)}else if("n"===n.key.toLowerCase()&&n.shiftKey){n.preventDefault();const o=this.getTabIndex("note");-1!==o&&this.navigateToTab(o)}}getTabIndex(n){let o=0;for(const a of this.ALL_TABS){if(a===n)return o;this.isTabVisible(a)&&o++}return-1}isTabVisible(n){return"package"!==n||this.showPackageTab}constructor(n,o,a,s,l,lt){this.route=n,this.customerProvider=o,this.formBuilder=a,this.location=s,this.router=l,this.navigationService=lt,this.customerName="Loading...",this.customerId=null,this.activeTabIndex=0,this.isFormModified=!1,this.currentCustomer=null,this.showPackageTab=!1,this.showSummaryTab={Summary:!0},this.showNoteTab={Note:!0},this.ALL_TABS=["package","internalPainting","wallpaper","texturePainting","paneling","curtains","furniture","services","doorGrills","summary","note"],this.tabModifications={package:!1,internalPainting:!1,wallpaper:!1,texturePainting:!1,paneling:!1,curtains:!1,furniture:!1,services:!1,doorGrills:!1,summary:!1,note:!1},this.quotationForm=this.formBuilder.group({package:this.formBuilder.array([]),internalPainting:this.formBuilder.group({}),wallpaper:this.formBuilder.group({}),texturePainting:this.formBuilder.group({}),paneling:this.formBuilder.group({}),curtains:this.formBuilder.group({}),furniture:this.formBuilder.group({}),services:this.formBuilder.group({}),doorGrills:this.formBuilder.group({}),note:this.formBuilder.group({}),summary:this.formBuilder.group({})}),this.quotationForm.valueChanges.subscribe(()=>{this.isFormModified=!0}),this.customerId=this.route.snapshot.params.customerId}ngOnInit(){this.route.params.subscribe(n=>{const o=n.customerId;if(o){this.customerId=Number(o);const a=this.customerProvider.getCustomerByIdFromState(this.customerId);a?(this.customerName=a.name,this.currentCustomer=a,this.showPackageTab="Apartment"===a.projectType):(this.customerProvider.listCustomer(),this.customerProvider.getCustomerById(this.customerId).subscribe(s=>{this.customerName=s.name||"Unknown Customer",this.currentCustomer=s,this.showPackageTab="Apartment"===s.projectType},s=>{this.customerName="Unknown Customer",console.error("Error fetching customer:",s)}))}})}navigateToTab(n){this.activeTabIndex=n,setTimeout(()=>{this.tabGroup.selectedIndex=n,this.tabGroup._tabs.forEach(o=>{o.position===n&&(o.isActive=!0)})})}onTabChange(n){this.activeTabIndex=n.index}onPackageModified(){this.isFormModified=!0,this.tabModifications.package=!0}onTabModified(n){this.isFormModified=!0,this.tabModifications[n]=!0}toggleSummaryVisibility(n){this.showSummaryTab[n]=!this.showSummaryTab[n]}toggleNoteVisibility(n){this.showNoteTab[n]=!this.showNoteTab[n]}navigateToDashboard(){null!==this.customerId?(this.navigationService.setCustomerId(this.customerId.toString()),this.router.navigate(["/dashboard/dashboard"])):console.error("Customer ID is null")}generateScopeDoc(){console.log("Generating Scope Document..."),Object.keys(this.tabModifications).forEach(n=>{this.tabModifications[n]=!1}),this.isFormModified=!1}getTabLabel(n,o){return{label:n,modified:this.tabModifications[o]}}get package(){return this.quotationForm.get("package")}handleFormChange(){this.isFormModified=!0}static{this.\u0275fac=function(o){return new(o||e)(t.rXU(u.nX),t.rXU(g.y),t.rXU(m.ok),t.rXU(c.aZ),t.rXU(u.Ix),t.rXU(h.o))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-view"]],viewQuery:function(o,a){if(1&o&&t.GBs(G,5),2&o){let s;t.mGM(s=t.lsd())&&(a.tabGroup=s.first)}},hostBindings:function(o,a){1&o&&t.bIt("keydown",function(l){return a.handleKeyDown(l)},!1,t.tSv)},decls:34,vars:8,consts:[[1,"quotation-builder-container"],[1,"header"],["mat-raised-button","",3,"ngStyle","click"],["mat-raised-button","",3,"click"],["src","/assets/left.png","width","45","height","45","routerLink","/customer/view",2,"background-size","cover","cursor","pointer"],[3,"formGroup"],[3,"selectedIndex","preserveContent","selectedIndexChange"],["tabGroup",""],[4,"ngIf"],["mat-tab-label",""],["matTabContent",""],["label","Wallpaper"],["label","Texture Painting"],["label","Paneling"],["label","Curtains"],["label","Furniture"],["label","Services"],["label","Doors & Grills"],["label","Summary"],["label","Note"],["class","modified-indicator",4,"ngIf"],[1,"modified-indicator"],["formGroupName","package",3,"formModified"],["formGroupName","internalPainting",3,"formModified"],["formGroupName","wallpaper"],["formGroupName","texturePainting"],["formGroupName","paneling"],["formGroupName","curtains"],["formGroupName","furniture"],["formGroupName","services"],["formGroupName","doorGrills"],["formGroupName","note"]],template:function(o,a){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return a.generateScopeDoc()}),t.EFF(5," Generate Scope Doc "),t.k0s(),t.j41(6,"button",3),t.bIt("click",function(){return a.navigateToDashboard()}),t.EFF(7," Back to Dashboard\n"),t.k0s(),t.nrm(8,"img",4),t.k0s(),t.j41(9,"form",5)(10,"mat-tab-group",6,7),t.bIt("selectedIndexChange",function(l){return a.activeTabIndex=l})("selectedIndexChange",function(l){return a.onTabChange(l)}),t.DNE(12,j,3,0,"mat-tab",8),t.j41(13,"mat-tab"),t.DNE(14,k,2,2,"ng-template",9),t.DNE(15,S,1,0,"ng-template",10),t.k0s(),t.j41(16,"mat-tab",11),t.DNE(17,E,1,0,"ng-template",10),t.k0s(),t.j41(18,"mat-tab",12),t.DNE(19,L,1,0,"ng-template",10),t.k0s(),t.j41(20,"mat-tab",13),t.DNE(21,R,1,0,"ng-template",10),t.k0s(),t.j41(22,"mat-tab",14),t.DNE(23,$,1,0,"ng-template",10),t.k0s(),t.j41(24,"mat-tab",15),t.DNE(25,X,1,0,"ng-template",10),t.k0s(),t.j41(26,"mat-tab",16),t.DNE(27,U,1,0,"ng-template",10),t.k0s(),t.j41(28,"mat-tab",17),t.DNE(29,O,1,0,"ng-template",10),t.k0s(),t.j41(30,"mat-tab",18),t.DNE(31,A,1,0,"ng-template",10),t.k0s(),t.j41(32,"mat-tab",19),t.DNE(33,Q,1,0,"ng-template",10),t.k0s()()()()),2&o&&(t.R7$(3),t.SpI("Quotation Builder - Customer Name: ",a.customerName,""),t.R7$(1),t.Y8G("ngStyle",t.eq3(6,Y,a.isFormModified?"red":"green")),t.R7$(5),t.Y8G("formGroup",a.quotationForm),t.R7$(1),t.Y8G("selectedIndex",a.activeTabIndex)("preserveContent",!0),t.R7$(2),t.Y8G("ngIf",a.showPackageTab))},dependencies:[c.bT,c.B3,u.Wk,m.qT,m.cb,m.j4,m.$R,p.$L,p.ES,p.mq,p.T8,b.J,v.f,C.s,T.u,y.r,x.U,I.K,M.j,F._,D.S,N.w,f.$z],styles:[".quotation-builder-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;justify-content:space-between}.actions[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:flex-end}.generate-scope-doc-btn[_ngcontent-%COMP%]{color:#fff;border:none;padding:10px;margin-top:20px;cursor:pointer}.generate-scope-doc-btn[_ngcontent-%COMP%]:hover{opacity:.9}.modified-indicator[_ngcontent-%COMP%]{color:#f44;font-size:18px;margin-left:5px;display:inline-block}  .mat-tab-label{height:auto!important;padding:12px 24px!important}  .mat-tab-label-content{display:flex!important;align-items:center!important}"]})}}return e})()},{path:"view",redirectTo:"",pathMatch:"full"}]}];let H=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[u.iI.forChild(_),u.iI]})}}return e})();var K=i(737),z=i(1683),W=i(2931),J=i(3152),Z=i(3321),q=i(3508),tt=i(3554),et=i(4280),nt=i(1718),ot=i(1084),it=i(2059),at=i(5440),rt=i(4412);let st=(()=>{class e{constructor(){this.dirtyFormsCount=0,this.formDirtyState=new rt.t(!1),this.formDirty$=this.formDirtyState.asObservable()}setFormDirty(n){n?this.dirtyFormsCount++:this.dirtyFormsCount=Math.max(0,this.dirtyFormsCount-1),this.formDirtyState.next(this.dirtyFormsCount>0)}resetAllForms(){this.dirtyFormsCount=0,this.formDirtyState.next(!1)}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),mt=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({providers:[st],imports:[c.MD,H,m.X1,p.RI,K.InternalPaintingModule,z.RequiremetnModule,W.TexturePaintingModule,m.YN,ot.WallpaperModule,J.PanelingModule,Z.CurtainsModule,q.FurnitureModule,tt.ServicesModule,et.DoorGrillsModule,nt.NoteModule,it.PackageModule,at.SummaryModule,f.Hl]})}}return e})()}}]);