"use strict";(self.webpackChunkRepainters=self.webpackChunkRepainters||[]).push([[931],{2931:(O,h,a)=>{a.r(h),a.d(h,{TexturePaintingModule:()=>P});var o=a(177),g=a(33),u=a(7705);const x=[{path:"",component:(()=>{class l{static{this.\u0275fac=function(c){return new(c||l)}}static{this.\u0275cmp=u.VBU({type:l,selectors:[["app-view"]],decls:2,vars:0,template:function(c,w){1&c&&(u.nrm(0,"router-outlet"),u.EFF(1,">"))},dependencies:[g.n3]})}}return l})(),children:[{path:"texture-painting",component:a(891).f}]}];let C=(()=>{class l{static{this.\u0275fac=function(c){return new(c||l)}}static{this.\u0275mod=u.$C({type:l})}static{this.\u0275inj=u.G2t({imports:[g.iI.forChild(x),g.iI]})}}return l})();var T=a(9417),v=a(5794);let P=(()=>{class l{static{this.\u0275fac=function(c){return new(c||l)}}static{this.\u0275mod=u.$C({type:l})}static{this.\u0275inj=u.G2t({imports:[o.MD,C,T.X1,v._B.forRoot({positionClass:"toast-top-right",preventDuplicates:!0,timeOut:3e3})]})}}return l})()},891:(O,h,a)=>{a.d(h,{f:()=>E});var o=a(9417),g=a(9969);class u{}var t=a(7705),b=a(33),x=a(4412),C=a(7468),T=a(1985),v=a(8032),P=a.n(v),l=a(6813),F=a(1626);let f=(()=>{class i{constructor(e){this.httpClient=e,this.baseUrl=l.c.backend.baseURL,this.texturePaintingMethod=this.baseUrl+"v1/texturepainting"}addTexturePainting(e){return this.httpClient.post(this.texturePaintingMethod+"/create",e)}listTexturePainting(e=""){return this.httpClient.get(this.texturePaintingMethod+e)}updateTexturePainting(e){return this.httpClient.post(`${this.texturePaintingMethod}/update/${e.texturePaintingId}`,e)}deleteTexturePainting(e){return this.httpClient.delete(`${this.texturePaintingMethod}/delete/${e}`)}getTexturePaintingByCustomerId(e){return this.httpClient.get(`${this.texturePaintingMethod}/customer/${e}`)}static{this.\u0275fac=function(r){return new(r||i)(t.KVO(F.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var c=a(5794);let w=(()=>{class i{get texturePainting(){return this._texturePainting.asObservable()}get addtexturePaintings(){return this._texturePaintings.asObservable()}constructor(e,r){this.texturePaintingService=e,this.toaster=r,this._texturePainting=new x.t([]),this.texturePaintingList={texturePainting:[]},this._texturePaintings=new x.t(new u),this.currentTexturePainting={_texturePaintings:new u}}addTexturePainting(e){const r=e.map(n=>this.texturePaintingService.addTexturePainting(n));(0,C.p)(r).subscribe({next:n=>{n.forEach((s,d)=>{const m=e[d];m.texturePaintingId=s.created_id,m.createdOn=m.createdOn||new Date,m.lastModifiedDate=new Date}),this._texturePainting.next([...this.texturePaintingList.texturePainting,...e]),this.toaster.success("Texture Painting Confirmed Successfully","Confirmation"),P().fire({icon:"success",title:"Success!",text:"Texture Painting added successfully.",confirmButtonText:"OK"})},error:n=>{console.error("Error adding texture painting:",n),this.toaster.error("Failed to add Texture Painting","Error"),P().fire({icon:"error",title:"Error!",text:"Failed to save Texture Painting.",confirmButtonText:"OK"})}})}listTexturePainting(){this.texturePaintingService.listTexturePainting().subscribe(e=>{this.texturePaintingList.texturePainting=e,this._texturePainting.next(Object.assign({},this.texturePaintingList).texturePainting)})}updateTexturePainting(e){this.texturePaintingService.updateTexturePainting(e).subscribe(r=>{e.lastModifiedDate=new Date;const n=this.texturePaintingList.texturePainting.findIndex(s=>s.texturePaintingId==e.texturePaintingId);-1!==n&&(this.texturePaintingList.texturePainting[n]=e),this._texturePainting.next([...this.texturePaintingList.texturePainting]),this.toaster.success("Internal Painting Updated Successfully","Confirmation")})}getTexturePaintingByCustomerId(e,r){return this.texturePaintingService.getTexturePaintingByCustomerId(e)}deleteTexturePainting(e){return new T.c(r=>{this.texturePaintingService.deleteTexturePainting(e.texturePaintingId).subscribe(n=>{this.texturePaintingList.texturePainting=this.texturePaintingList.texturePainting.filter(s=>s.texturePaintingId!==e.texturePaintingId),this._texturePainting.next([...this.texturePaintingList.texturePainting]),this.toaster.success("Texture Painting Deleted Successfully","Success"),r.next(n),r.complete()},n=>{this.toaster.error("Failed to delete texture painting","Error"),r.error(n)})})}static{this.\u0275fac=function(r){return new(r||i)(t.KVO(f),t.KVO(c.tw))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var M=a(177);function y(i,p){1&i&&(t.j41(0,"div",36),t.EFF(1," Area must be at least 100 sq ft "),t.k0s())}function I(i,p){if(1&i&&(t.j41(0,"option",37),t.EFF(1),t.k0s()),2&i){const e=p.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function X(i,p){if(1&i&&(t.j41(0,"option",37),t.EFF(1),t.k0s()),2&i){const e=p.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function k(i,p){if(1&i){const e=t.RV6();t.j41(0,"div",18)(1,"div",6)(2,"div",19)(3,"span",20),t.EFF(4),t.k0s(),t.j41(5,"button",21),t.bIt("click",function(){const s=t.eBV(e).index,d=t.XpG();return t.Njj(d.removeWall(s))}),t.EFF(6,"Remove"),t.k0s()(),t.j41(7,"div",22)(8,"div",23)(9,"label",24),t.EFF(10,"Area Sft"),t.k0s(),t.j41(11,"div",25),t.nrm(12,"input",26),t.j41(13,"span",27),t.EFF(14,"sq ft"),t.k0s()(),t.DNE(15,y,2,0,"div",28),t.k0s(),t.j41(16,"div",23)(17,"label",24),t.EFF(18,"Type"),t.k0s(),t.j41(19,"div",29)(20,"select",30)(21,"option",31),t.EFF(22,"Select paint type"),t.k0s(),t.DNE(23,I,2,2,"option",32),t.k0s()()(),t.j41(24,"div",23)(25,"label",24),t.EFF(26,"Product Code"),t.k0s(),t.j41(27,"div",29)(28,"select",33),t.DNE(29,X,2,2,"option",32),t.k0s()()(),t.j41(30,"div",23)(31,"label",24),t.EFF(32,"Price"),t.k0s(),t.j41(33,"div",25)(34,"span",13),t.EFF(35,"\u20b9"),t.k0s(),t.nrm(36,"input",34),t.k0s()(),t.j41(37,"div",23)(38,"label",24),t.EFF(39,"Remarks"),t.k0s(),t.j41(40,"div",25),t.nrm(41,"input",35),t.k0s()()()()()}if(2&i){const e=p.$implicit,r=p.index,n=t.XpG();let s,d,m;t.Y8G("@fadeSlideInOut",void 0),t.R7$(1),t.Y8G("formGroup",n.getWallFormGroup(e)),t.R7$(3),t.SpI("Wall ",r+1,""),t.R7$(11),t.Y8G("ngIf",!n.isWallAreaValid(e)&&(null==(s=n.getWallFormGroup(e).get("area"))?null:s.touched)),t.R7$(8),t.Y8G("ngForOf",n.texturetype),t.R7$(5),t.Y8G("disabled",!(null!=(d=e.get("type"))&&d.value)),t.R7$(1),t.Y8G("ngForOf",n.getProductCodes(null==(m=e.get("type"))?null:m.value))}}let E=(()=>{class i{constructor(e,r,n,s,d){this.fb=e,this.cdRef=r,this.route=n,this.texturePaintingProvider=s,this.toastr=d,this.customerId=null,this.currenttexturepainting=new u,this.texturetype=["Classic","Premium","Azzure","Custom"],this.pricerates={Classic:250,Premium:500,Azzure:700,Custom:2500},this.productCodes={Classic:["TX001","TX002","TX003","TX007","TX008","TX009","TX010","TX011","TX012","TX027","TX028","TX029","TX032","TX033","TX034","TX038","TX039","TX040","TX041","TX042","TX043","TX044"],Premium:["TX004","TX005","TX006","TX021","TX022","TX023","TX024","TX025","TX026","TX030","TX031"],Azzure:["TX013","TX014","TX015","TX016","TX017","TX018","TX019","TX020","TX035","TX036","TX037"],Custom:["TX999"]},this.textureForm=this.fb.group({texturePaintings:this.fb.array([]),sectionTotal:new o.MJ(0),totalRows:new o.MJ(0)})}ngOnInit(){this.extractCustomerId(),this.customerId?this.fetchTexturePaintingData():this.addNewWall()}fetchTexturePaintingData(){null!==this.customerId&&this.texturePaintingProvider.getTexturePaintingByCustomerId(this.customerId,{delete:0}).subscribe(e=>{e&&e.length>0?(this.texturePaintings.clear(),e.forEach(r=>{const n=this.createWallFormGroup();n.patchValue({texturePaintingId:r.texturePaintingId,area:Number(r.area),type:r.type,productCode:r.productCode,price:r.price,remarks:r.remarks,isNew:!1}),this.texturePaintings.push(n)}),this.updateSectionTotal()):this.addNewWall()},e=>{console.error("Error fetching texturing painting data:",e),this.toastr.error("Error loading existing texture painting data")})}extractCustomerId(){this.route.parent?.paramMap.subscribe(e=>{const r=e.get("customerId");this.customerId=r?parseInt(r,10):null,console.log("Parent Route Customer ID:",this.customerId)}),this.route.paramMap.subscribe(e=>{const r=e.get("customerId");r&&(this.customerId=parseInt(r,10),console.log("Current Route Customer ID:",this.customerId))}),this.currenttexturepainting&&this.currenttexturepainting.customerId&&(this.customerId=this.currenttexturepainting.customerId,console.log("Current Texture Painting Customer ID:",this.customerId))}get texturePaintings(){return this.textureForm.get("texturePaintings")}getWallFormGroup(e){return e}getSectionTotalControl(){return this.textureForm.get("sectionTotal")}createWallFormGroup(){const e=this.fb.group({texturePaintingId:new o.MJ(null),area:new o.MJ(100,[o.k0.required,o.k0.min(100)]),type:new o.MJ(null),productCode:new o.MJ(null),price:new o.MJ(0),remarks:new o.MJ(""),isNew:new o.MJ(!0,{nonNullable:!0})});return e.get("type")?.valueChanges.subscribe(r=>{const n=e.get("productCode");r&&this.productCodes[r]?n?.enable():n?.disable()}),e}updatePrice(e){const r=Number(e.get("area")?.value)||0,n=e.get("type")?.value;r>=100&&n&&this.pricerates[n]&&(e.patchValue({price:r*this.pricerates[n]},{emitEvent:!1}),this.updateSectionTotal())}updateSectionTotal(){const e=this.texturePaintings.controls.reduce((r,n)=>r+(Number(n.get("price")?.value)||0),0);this.textureForm.patchValue({sectionTotal:e},{emitEvent:!1}),this.cdRef.detectChanges()}onConfirmTexturePainting(){if(!this.customerId)return void this.toastr.error("Customer ID is required");const e=localStorage.getItem("UserId");if(!e)return void this.toastr.error("User ID not found. Please try logging in again.");const r=this.texturePaintings.controls.filter(n=>!0===n.get("isNew")?.value).map(n=>({customerId:this.customerId,area:n.get("area")?.value.toString(),type:n.get("type")?.value,productCode:n.get("productCode")?.value,price:n.get("price")?.value,remarks:n.get("remarks")?.value,sectionTotal:this.textureForm.get("sectionTotal")?.value.toString(),createdBy:parseInt(e),lastModifiedBy:parseInt(e)}));0!==r.length?(this.texturePaintingProvider.addTexturePainting(r),this.texturePaintings.controls.filter(n=>!0===n.get("isNew")?.value).forEach(n=>n.get("isNew")?.setValue(!1))):this.toastr.info("No new texture paintings to save")}addNewWall(){const e=this.createWallFormGroup();e.get("area")?.valueChanges.subscribe(()=>this.updatePrice(e)),e.get("type")?.valueChanges.subscribe(()=>this.updatePrice(e)),this.texturePaintings.push(e),this.updateTotalRows()}removeWall(e){const n=this.texturePaintings.at(e).get("texturePaintingId")?.value;if(n){const s=new u;s.texturePaintingId=n,this.texturePaintingProvider.deleteTexturePainting(s).subscribe(()=>{this.texturePaintings.removeAt(e),this.updateSectionTotal(),this.updateTotalRows()},d=>{console.error("Error deleting texture painting:",d)})}else this.texturePaintings.removeAt(e),this.updateSectionTotal(),this.updateTotalRows()}updateTotalRows(){this.textureForm.patchValue({totalRows:this.texturePaintings.length},{emitEvent:!1})}isWallAreaValid(e){const n=e.get("area");return!!n&&!n.errors}getProductCodes(e){return e?this.productCodes[e]:[]}static{this.\u0275fac=function(r){return new(r||i)(t.rXU(o.ok),t.rXU(t.gRc),t.rXU(b.nX),t.rXU(w),t.rXU(c.tw))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-texture-painting"]],inputs:{currenttexturepainting:"currenttexturepainting"},decls:27,vars:5,consts:[[1,"toastr-container"],[1,"main-container"],[1,"header"],[1,"title"],["type","button",1,"add-wall-btn",3,"click"],[1,"plus-icon"],[3,"formGroup"],[1,"walls-container"],["class","wall-card",4,"ngFor","ngForOf"],[1,"total-section"],[1,"total-content"],[1,"total-label"],[1,"total-input-wrapper"],[1,"input-prefix"],["type","number","formControlName","sectionTotal","readonly","",3,"formControl"],[1,"row-count"],[1,"confirm-section"],[1,"confirm-btn",3,"disabled","click"],[1,"wall-card"],[1,"wall-header"],[1,"wall-number"],["type","button",1,"remove-btn",3,"click"],[1,"form-grid"],[1,"form-group"],[1,"form-label"],[1,"input-wrapper"],["type","string","formControlName","area","placeholder","100"],[1,"input-suffix"],["class","error-message",4,"ngIf"],[1,"select-wrapper"],["formControlName","type"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","productCode",3,"disabled"],["type","number","formControlName","price","readonly",""],["type","text","formControlName","remarks","placeholder","Enter Remarks"],[1,"error-message"],[3,"value"]],template:function(r,n){if(1&r&&(t.nrm(0,"div",0),t.j41(1,"div",1)(2,"div",2)(3,"h2",3),t.EFF(4,"E. Texture Painting"),t.k0s(),t.j41(5,"button",4),t.bIt("click",function(){return n.addNewWall()}),t.j41(6,"span",5),t.EFF(7,"+"),t.k0s(),t.j41(8,"span"),t.EFF(9,"Add New Wall"),t.k0s()()(),t.j41(10,"form",6)(11,"div",7),t.DNE(12,k,42,7,"div",8),t.k0s(),t.j41(13,"div",9)(14,"div",10)(15,"span",11),t.EFF(16,"Section Total Texture Painting"),t.k0s(),t.j41(17,"div",12)(18,"span",13),t.EFF(19,"\u20b9"),t.k0s(),t.nrm(20,"input",14),t.k0s(),t.j41(21,"div",15)(22,"span"),t.EFF(23),t.k0s()()()()(),t.j41(24,"div",16)(25,"button",17),t.bIt("click",function(){return n.onConfirmTexturePainting()}),t.EFF(26," Confirm Texture Painting "),t.k0s()()()),2&r){let s;t.R7$(10),t.Y8G("formGroup",n.textureForm),t.R7$(2),t.Y8G("ngForOf",n.texturePaintings.controls),t.R7$(8),t.Y8G("formControl",n.getSectionTotalControl()),t.R7$(3),t.SpI("Total Rows: ",null==(s=n.textureForm.get("totalRows"))?null:s.value,""),t.R7$(2),t.Y8G("disabled",n.textureForm.invalid)}},dependencies:[M.Sq,M.bT,o.qT,o.xH,o.y7,o.me,o.Q0,o.wz,o.BC,o.cb,o.l_,o.j4,o.JD],styles:['*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif}.main-container[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:2rem;box-shadow:0 10px 30px #0000000d;max-width:2000px;margin:0 auto;background:linear-gradient(135deg,#b5ac9c 0%,#75ba9d 100%)}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #75ba9d}.title[_ngcontent-%COMP%]{font-size:1.8rem;color:#000;font-weight:600;position:relative;padding-left:1rem}.title[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:70%;background:#75ba9d;border-radius:2px}.add-wall-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#75ba9d,#b5ac9c);border:none;padding:.8rem 1.5rem;border-radius:12px;color:#fff;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:.5rem;transition:transform .2s,box-shadow .2s}.add-wall-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 5px 15px #75ba9d4d}.plus-icon[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700}.remove-btn[_ngcontent-%COMP%]{background:#fff;color:#dc3545;border:2px solid #dc3545;padding:.5rem 1rem;border-radius:8px;display:flex;align-items:center;gap:.5rem;cursor:pointer;transition:all .3s ease;font-size:.9rem;font-weight:500}.remove-btn[_ngcontent-%COMP%]:hover{background:#dc3545;color:#fff;transform:translateY(-2px);box-shadow:0 4px 8px #dc354533}.walls-container[_ngcontent-%COMP%]{display:grid;gap:1.5rem}.wall-card[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:16px;overflow:hidden;transition:transform .3s,box-shadow .3s;border:1px solid rgba(181,172,156,.2)}.wall-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 20px #0000000d}.wall-header[_ngcontent-%COMP%]{background:linear-gradient(to right,rgba(117,186,157,.1),rgba(181,172,156,.1));padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(0,0,0,.05)}.wall-number[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;font-size:1.1rem}.wall-drag-handle[_ngcontent-%COMP%]{color:#b5ac9c;cursor:move;font-size:1.2rem;-webkit-user-select:none;user-select:none}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;padding:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-label[_ngcontent-%COMP%]{font-size:.9rem;color:#555;font-weight:500}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .select-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.8rem 1rem;border:2px solid rgba(181,172,156,.2);border-radius:10px;font-size:.95rem;transition:all .3s ease;background:white}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .select-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#75ba9d;box-shadow:0 0 0 3px #75ba9d1a}.input-prefix[_ngcontent-%COMP%], .input-suffix[_ngcontent-%COMP%]{position:absolute;color:#666;font-size:.9rem}.input-prefix[_ngcontent-%COMP%]{left:1rem}.input-suffix[_ngcontent-%COMP%]{right:1rem}.input-wrapper[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .input-wrapper[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding-left:2rem}.select-wrapper[_ngcontent-%COMP%]{position:relative}.select-arrow[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);color:#75ba9d;pointer-events:none;font-size:.8rem}.total-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:2px dashed rgba(181,172,156,.3)}.total-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:linear-gradient(to right,#75ba9d,#b5ac9c);padding:1.5rem;border-radius:12px;color:#fff}.total-label[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem}.total-input-wrapper[_ngcontent-%COMP%]{position:relative;width:200px}.total-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.8rem 1rem .8rem 2rem;border:2px solid rgba(255,255,255,.2);border-radius:8px;background:rgba(255,255,255,.1);color:#fff;font-size:1.1rem;font-weight:500}.total-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#fff9}.total-input-wrapper[_ngcontent-%COMP%]   .input-prefix[_ngcontent-%COMP%]{color:#fff}.confirm-btn[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;height:50px;color:#000;border-radius:10%;background-color:#0e412c;cursor:pointer;margin-left:20px;margin-top:20px;margin-bottom:20px}@keyframes _ngcontent-%COMP%_fadeSlideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.wall-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeSlideIn .3s ease-out forwards}@media (max-width: 768px){.main-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.total-content[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.total-input-wrapper[_ngcontent-%COMP%]{width:100%}}'],data:{animation:[(0,g.hZ)("fadeSlideInOut",[(0,g.kY)(":enter",[(0,g.iF)({opacity:0,transform:"translateY(20px)"}),(0,g.i0)("300ms ease-out",(0,g.iF)({opacity:1,transform:"translateY(0)"}))])])]}})}}return i})()}}]);