"use strict";(self.webpackChunkRepainters=self.webpackChunkRepainters||[]).push([[84],{1084:(P,g,n)=>{n.r(g),n.d(g,{WallpaperModule:()=>C});var o=n(177),i=n(7705);let u=(()=>{class s{static{this.\u0275fac=function(c){return new(c||s)}}static{this.\u0275cmp=i.VBU({type:s,selectors:[["app-view"]],decls:2,vars:0,template:function(c,O){1&c&&(i.j41(0,"p"),i.EFF(1,"view works!"),i.k0s())}})}}return s})();var m=n(33);const x=[{path:"",component:u,children:[{path:"wallpaper",component:n(3158).s}]}];let w=(()=>{class s{static{this.\u0275fac=function(c){return new(c||s)}}static{this.\u0275mod=i.$C({type:s})}static{this.\u0275inj=i.G2t({imports:[m.iI.forChild(x),m.iI]})}}return s})();var b=n(9417);let C=(()=>{class s{static{this.\u0275fac=function(c){return new(c||s)}}static{this.\u0275mod=i.$C({type:s})}static{this.\u0275inj=i.G2t({imports:[o.MD,w,b.X1]})}}return s})()},3158:(P,g,n)=>{n.d(g,{s:()=>T});var o=n(9417),i=n(9969);class u{}var m=n(980),t=n(7705),x=n(33),w=n(4412),b=n(7468),C=n(8810),s=n(1985),f=n(8141),h=n(9437),c=n(8032),O=n.n(c),F=n(6813),y=n(1626);let I=(()=>{class l{constructor(e){this.httpClient=e,this.baseUrl=F.c.backend.baseURL,this.wallpaperMethod=this.baseUrl+"v1/wallpaper"}addWallpaper(e){return this.httpClient.post(this.wallpaperMethod+"/create",e)}listWallpaper(e=""){return this.httpClient.get(this.wallpaperMethod+e)}updateWallpaper(e){return this.httpClient.post(`${this.wallpaperMethod}/update/${e.wallpaperId}`,e)}deleteWallpaper(e){return this.httpClient.delete(`${this.wallpaperMethod}/delete/${e}`)}getWallpaperByCustomerId(e){return this.httpClient.get(`${this.wallpaperMethod}/customer/${e}`)}static{this.\u0275fac=function(a){return new(a||l)(t.KVO(y.Qq))}}static{this.\u0275prov=t.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var M=n(5794);let k=(()=>{class l{get wallpaper(){return this._wallpaper.asObservable()}get wallpapers(){return this._wallpapers.asObservable()}constructor(e,a){this.WallpaperSerivce=e,this.toaster=a,this._wallpaper=new w.t([]),this.wallpaperList={wallpaper:[]},this._wallpapers=new w.t(new u),this.currentWallpaper={_wallpapers:new u}}addWallpaper(e){const a=e.map(r=>this.WallpaperSerivce.addWallpaper(r).pipe((0,f.M)(p=>{r.wallpaperId=p.created_id,this.wallpaperList.wallpaper.push(r)})));return(0,b.p)(a).pipe((0,f.M)(()=>{this._wallpaper.next([...this.wallpaperList.wallpaper]),this.toaster.success("Wallpaper Confirmed Successfully","Confirmation"),O().fire({icon:"success",title:"Success!",text:"Wallpaper added successfully.",confirmButtonText:"OK"})}),(0,h.W)(r=>(console.error("Error adding wallpaper:",r),this.toaster.error("Failed to add Wallpaper","Error"),O().fire({icon:"error",title:"Error!",text:"Failed to save Wallpaper.",confirmButtonText:"OK"}),(0,C.$)(r))))}listWallpaper(){this.WallpaperSerivce.listWallpaper().subscribe(e=>{this.wallpaperList.wallpaper=e,this._wallpaper.next(Object.assign({},this.wallpaperList).wallpaper)})}updateWallpaper(e){const a=e.map(r=>this.WallpaperSerivce.updateWallpaper(r).pipe((0,f.M)(()=>{const p=this.wallpaperList.wallpaper.findIndex(d=>d.wallpaperId===r.wallpaperId);-1!==p&&(this.wallpaperList.wallpaper[p]=r)})));return(0,b.p)(a).pipe((0,f.M)(()=>{this._wallpaper.next([...this.wallpaperList.wallpaper]),this.toaster.success("Wallpaper Updated Successfully","Confirmation")}))}getWallpaperByCustomerId(e,a){return this.WallpaperSerivce.getWallpaperByCustomerId(e).pipe((0,f.M)(r=>{console.log("Wallpaper data received:",r),this._wallpaper.next(r)}),(0,h.W)(r=>(console.error("Error fetching wallpaper data:",r),this.toaster.error("Failed to fetch wallpaper data"),(0,C.$)(()=>r))))}deleteWallpaper(e){return new s.c(a=>{this.WallpaperSerivce.deleteWallpaper(e.wallpaperId).subscribe(r=>{this.wallpaperList.wallpaper=this.wallpaperList.wallpaper.filter(p=>p.wallpaperId!==e.wallpaperId),this._wallpaper.next([...this.wallpaperList.wallpaper]),this.toaster.success("Wallpaper Deleted Successfully","Success"),a.next(r),a.complete()},r=>{this.toaster.error("Failed to delete Wallpaper","Error"),a.error(r)})})}static{this.\u0275fac=function(a){return new(a||l)(t.KVO(I),t.KVO(M.tw))}}static{this.\u0275prov=t.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var W=n(177);function R(l,v){if(1&l&&(t.j41(0,"option",35),t.EFF(1),t.k0s()),2&l){const e=v.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function E(l,v){1&l&&(t.j41(0,"div",36),t.EFF(1," \u26a0\ufe0f Number of rolls exceeds the limit of 20! "),t.k0s())}function j(l,v){if(1&l){const e=t.RV6();t.j41(0,"div",9)(1,"div",10)(2,"span",11),t.EFF(3),t.k0s(),t.j41(4,"div",12),t.nrm(5,"span",13),t.j41(6,"button",14),t.bIt("click",function(){const p=t.eBV(e).index,d=t.XpG();return t.Njj(d.removeWallpaper(p))}),t.EFF(7,"Remove"),t.k0s()()(),t.j41(8,"form",15)(9,"div",16)(10,"label",17),t.EFF(11,"Product Type"),t.k0s(),t.j41(12,"div",18)(13,"select",19)(14,"option",20),t.EFF(15,"Select product type"),t.k0s(),t.DNE(16,R,2,2,"option",21),t.k0s()()(),t.j41(17,"div",16)(18,"label",17),t.EFF(19,"Product Code"),t.k0s(),t.j41(20,"div",22),t.nrm(21,"input",23),t.k0s()(),t.j41(22,"div",16)(23,"label",17),t.EFF(24,"Number of Rolls"),t.k0s(),t.j41(25,"div",22),t.nrm(26,"input",24),t.k0s(),t.DNE(27,E,2,0,"div",25),t.k0s(),t.j41(28,"div",16)(29,"label",17),t.EFF(30,"Price"),t.k0s(),t.j41(31,"div",22)(32,"span",26),t.EFF(33,"\u20b9"),t.k0s(),t.nrm(34,"input",27),t.k0s()(),t.j41(35,"div",16)(36,"label",17),t.EFF(37,"Remarks"),t.k0s(),t.j41(38,"div",22),t.nrm(39,"input",28),t.k0s()()(),t.j41(40,"div",29)(41,"div",30)(42,"span",31),t.EFF(43,"Section Total Wallpaper B"),t.k0s(),t.j41(44,"div",32),t.nrm(45,"input",33),t.k0s(),t.j41(46,"div",34)(47,"span"),t.EFF(48),t.k0s()()()()()}if(2&l){const e=v.index,a=t.XpG();let r,p;t.Y8G("formGroup",a.getWallpaperGroup(e)),t.R7$(3),t.SpI("Wall ",e+1,""),t.R7$(5),t.Y8G("formGroup",a.getWallpaperGroup(e)),t.R7$(8),t.Y8G("ngForOf",a.productTypes),t.R7$(11),t.Y8G("ngIf",null==(r=a.getWallpaperGroup(e).get("noOfRolls"))||null==r.errors?null:r.errors.rollsLimitExceeded),t.R7$(21),t.SpI("Total Rows: ",null==(p=a.wallpaperForm.get("totalRows"))?null:p.value,"")}}let T=(()=>{class l{constructor(e,a,r,p,d){this.fb=e,this.cdRef=a,this.route=r,this.wallpaperProvider=p,this.toastr=d,this.customerId=null,this.currentWallpaper=new u,this.productTypes=["Classic","Premium","Azzure","Custom"],this.pricerates={Classic:7500,Premium:15e3,Azzure:25e3,Custom:35e3},this.isLoading=!1,this.wallpaperForm=this.fb.group({wallpapers:this.fb.array([]),sectionTotal:new o.MJ(0),totalRows:new o.MJ(0)})}ngOnInit(){this.extractCustomerId(),this.customerId?this.fetchWallpaperData():this.addNewWallpaper()}fetchWallpaperData(){null!==this.customerId&&(console.log("Fetching wallpaper data for customer:",this.customerId),this.isLoading=!0,this.wallpaperProvider.getWallpaperByCustomerId(this.customerId,{deleted:0}).pipe((0,m.j)(()=>{this.isLoading=!1,this.cdRef.detectChanges()})).subscribe({next:e=>{e&&e.length>0?(this.wallpapers.clear(),e.forEach(a=>{const r=this.createWallpaperFormGroup();r.patchValue({wallpaperId:a.wallpaperId,productType:a.productType,productCode:a.productCode,noOfRolls:a.noOfRolls,price:a.price,remarks:a.remarks,isNew:!1},{emitEvent:!1}),this.wallpapers.push(r)}),this.updateSectionTotal()):this.addNewWallpaper()},error:e=>{console.error("Error in component while fetching wallpaper data:",e),this.toastr.error("Error loading existing wallpaper data")}}))}extractCustomerId(){this.route.parent?.paramMap.subscribe(e=>{const a=e.get("customerId");this.customerId=a?parseInt(a,10):null,this.customerId&&this.fetchWallpaperData(),console.log("Parent Route Customer ID:",this.customerId)}),this.route.paramMap.subscribe(e=>{const a=e.get("customerId");a&&(this.customerId=parseInt(a,10),console.log("Current Route Customer ID:",this.customerId))}),this.currentWallpaper&&this.currentWallpaper.customerId&&(this.customerId=this.currentWallpaper.customerId,this.fetchWallpaperData())}get wallpapers(){return this.wallpaperForm.get("wallpapers")}getWallpaperGroup(e){return this.wallpapers.at(e)}createWallpaperFormGroup(){const e=this.fb.group({wallpaperId:new o.MJ(null),productType:new o.MJ(null,o.k0.required),productCode:new o.MJ(null,o.k0.required),noOfRolls:new o.MJ(1,[o.k0.required,o.k0.min(1),o.k0.max(20)]),price:new o.MJ(0),remarks:new o.MJ(""),isNew:new o.MJ(!0,{nonNullable:!0})});return e.get("productType")?.valueChanges.subscribe(()=>this.updatePrice(e)),e.get("noOfRolls")?.valueChanges.subscribe(()=>this.updatePrice(e)),e}updatePrice(e){const a=Number(e.get("noOfRolls")?.value)||0,r=e.get("productType")?.value;a>0&&r&&this.pricerates[r]&&(e.patchValue({price:a*this.pricerates[r]},{emitEvent:!1}),this.updateSectionTotal())}updateSectionTotal(){const e=this.wallpapers.controls.reduce((a,r)=>a+(Number(r.get("price")?.value)||0),0);this.wallpaperForm.patchValue({sectionTotal:e},{emitEvent:!1}),this.cdRef.detectChanges()}onConfirmWallpaper(){if(!this.customerId)return void this.toastr.error("Customer ID is required");const e=localStorage.getItem("UserId");if(!e)return void this.toastr.error("User ID not found. Please try logging in again.");const a=this.wallpapers.controls.filter(r=>!0===r.get("isNew")?.value).map(r=>({customerId:this.customerId,productType:r.get("productType")?.value,productCode:r.get("productCode")?.value,noOfRolls:r.get("noOfRolls")?.value,price:r.get("price")?.value,remarks:r.get("remarks")?.value,sectionTotal:this.wallpaperForm.get("sectionTotal")?.value?.toString(),createdBy:parseInt(e),lastModifiedBy:parseInt(e)}));0!==a.length?(this.isLoading=!0,this.wallpaperProvider.addWallpaper(a).pipe((0,m.j)(()=>{this.isLoading=!1,this.cdRef.detectChanges()})).subscribe({next:()=>{this.fetchWallpaperData()},error:r=>{this.toastr.error("Error saving wallpaper data"),console.error("Error:",r)}})):this.toastr.info("No new wallpapers to save")}addNewWallpaper(){const e=this.createWallpaperFormGroup();this.wallpapers.push(e),this.updateTotalRows()}removeWallpaper(e){const r=this.wallpapers.at(e).get("wallpaperId")?.value;if(r){this.isLoading=!0;const p=new u;p.wallpaperId=r,this.wallpaperProvider.deleteWallpaper(p).pipe((0,m.j)(()=>{this.isLoading=!1,this.cdRef.detectChanges()})).subscribe({next:()=>{this.wallpapers.removeAt(e),this.updateSectionTotal(),this.updateTotalRows()},error:d=>{console.error("Error deleting wallpaper:",d),this.toastr.error("Failed to delete wallpaper")}})}else this.wallpapers.removeAt(e),this.updateSectionTotal(),this.updateTotalRows()}updateTotalRows(){this.wallpaperForm.patchValue({totalRows:this.wallpapers.length},{emitEvent:!1})}static{this.\u0275fac=function(a){return new(a||l)(t.rXU(o.ok),t.rXU(t.gRc),t.rXU(x.nX),t.rXU(k),t.rXU(M.tw))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-wallpaper"]],inputs:{currentWallpaper:"currentWallpaper"},decls:14,vars:1,consts:[[1,"main-container"],[1,"header"],[1,"title"],[1,"add-wall-btn",3,"click"],[1,"plus-icon"],[1,"walls-container"],["class","wall-card",3,"formGroup",4,"ngFor","ngForOf"],[1,"confirm-section"],[1,"confirm-btn",3,"click"],[1,"wall-card",3,"formGroup"],[1,"wall-header"],[1,"wall-number"],[1,"wall-actions"],[1,"wall-drag-handle"],[1,"remove-btn",3,"click"],[1,"form-grid",3,"formGroup"],[1,"form-group"],[1,"form-label"],[1,"select-wrapper"],["formControlName","productType"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"input-wrapper"],["type","text","formControlName","productCode","placeholder","Enter product code"],["type","number","formControlName","noOfRolls","placeholder","Number of rolls"],["class","warning",4,"ngIf"],[1,"input-prefix"],["type","number","formControlName","price","placeholder","Amount"],["type","text","formControlName","remarks","placeholder","Enter Remarks"],[1,"total-section"],[1,"total-content"],[1,"total-label"],[1,"total-input-wrapper"],["type","text","formControlName","sectionTotal","placeholder","0.00","readonly",""],[1,"row-count"],[3,"value"],[1,"warning"]],template:function(a,r){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3,"C. Wallpaper"),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return r.addNewWallpaper()}),t.j41(5,"span",4),t.EFF(6,"+"),t.k0s(),t.j41(7,"span"),t.EFF(8,"Add New Wallpaper"),t.k0s()()(),t.j41(9,"div",5),t.DNE(10,j,49,6,"div",6),t.j41(11,"div",7)(12,"button",8),t.bIt("click",function(){return r.onConfirmWallpaper()}),t.EFF(13," Confirm Wallpaper "),t.k0s()()()()),2&a&&(t.R7$(10),t.Y8G("ngForOf",r.wallpapers.controls))},dependencies:[W.Sq,W.bT,o.qT,o.xH,o.y7,o.me,o.Q0,o.wz,o.BC,o.cb,o.j4,o.JD],styles:['*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif}.main-container[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:2rem;box-shadow:0 10px 30px #0000000d;max-width:2000px;margin:0 auto;background:linear-gradient(135deg,#b5ac9c 0%,#75ba9d 100%)}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #75ba9d}.title[_ngcontent-%COMP%]{font-size:1.8rem;color:#000;font-weight:600;position:relative;padding-left:1rem}.title[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:70%;background:#75ba9d;border-radius:2px}.add-wall-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#75ba9d,#b5ac9c);border:none;padding:.8rem 1.5rem;border-radius:12px;color:#fff;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:.5rem;transition:transform .2s,box-shadow .2s}.add-wall-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 5px 15px #75ba9d4d}.plus-icon[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700}.remove-btn[_ngcontent-%COMP%]{background:#fff;color:#dc3545;border:2px solid #dc3545;padding:.5rem 1rem;border-radius:8px;display:flex;align-items:center;gap:.5rem;cursor:pointer;transition:all .3s ease;font-size:.9rem;font-weight:500}.remove-btn[_ngcontent-%COMP%]:hover{background:#dc3545;color:#fff;transform:translateY(-2px);box-shadow:0 4px 8px #dc354533}.walls-container[_ngcontent-%COMP%]{display:grid;gap:1.5rem}.wall-card[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:16px;overflow:hidden;transition:transform .3s,box-shadow .3s;border:1px solid rgba(181,172,156,.2)}.wall-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 20px #0000000d}.wall-header[_ngcontent-%COMP%]{background:linear-gradient(to right,rgba(117,186,157,.1),rgba(181,172,156,.1));padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(0,0,0,.05)}.wall-number[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;font-size:1.1rem}.wall-drag-handle[_ngcontent-%COMP%]{color:#b5ac9c;cursor:move;font-size:1.2rem;-webkit-user-select:none;user-select:none}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;padding:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-label[_ngcontent-%COMP%]{font-size:.9rem;color:#555;font-weight:500}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .select-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.8rem 1rem;border:2px solid rgba(181,172,156,.2);border-radius:10px;font-size:.95rem;transition:all .3s ease;background:white}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .select-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#75ba9d;box-shadow:0 0 0 3px #75ba9d1a}.input-prefix[_ngcontent-%COMP%], .input-suffix[_ngcontent-%COMP%]{position:absolute;color:#666;font-size:.9rem}.input-prefix[_ngcontent-%COMP%]{left:1rem}.input-suffix[_ngcontent-%COMP%]{right:1rem}.input-wrapper[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .input-wrapper[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding-left:2rem}.select-wrapper[_ngcontent-%COMP%]{position:relative}.select-arrow[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);color:#75ba9d;pointer-events:none;font-size:.8rem}.total-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:2px dashed rgba(181,172,156,.3)}.total-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:black;padding:1.5rem;border-radius:12px;color:#fff}.total-label[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem}.total-input-wrapper[_ngcontent-%COMP%]{position:relative;width:200px}.total-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.8rem 1rem .8rem 2rem;border:2px solid rgba(255,255,255,.2);border-radius:8px;background:rgba(255,255,255,.1);color:#fff;font-size:1.1rem;font-weight:500}.total-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#fff9}.total-input-wrapper[_ngcontent-%COMP%]   .input-prefix[_ngcontent-%COMP%]{color:#fff}.confirm-btn[_ngcontent-%COMP%]{width:100%}.confirm-btn[_ngcontent-%COMP%]{width:auto;height:50px;color:#000;border-radius:30%;background-color:#0e412c;cursor:pointer;margin-left:20px;margin-top:20px;margin-bottom:20px;padding:10px}@keyframes _ngcontent-%COMP%_fadeSlideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.wall-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeSlideIn .3s ease-out forwards}@media (max-width: 768px){.main-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.total-content[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.total-input-wrapper[_ngcontent-%COMP%]{width:100%}}'],data:{animation:[(0,i.hZ)("fadeSlideInOut",[(0,i.kY)(":enter",[(0,i.iF)({opacity:0,transform:"translateY(20px)"}),(0,i.i0)("300ms ease-out",(0,i.iF)({opacity:1,transform:"translateY(0)"}))])])]}})}}return l})()}}]);