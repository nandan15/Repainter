"use strict";(self.webpackChunkRepainters=self.webpackChunkRepainters||[]).push([[780],{2780:(ft,c,i)=>{i.r(c),i.d(c,{QuotationBuilderModule:()=>dt});var d=i(177),l=i(9417),u=i(33),f=i(6977),g=i(1413),t=i(7705),h=i(65),b=i(4651),p=i(6850),v=i(4028),C=i(891),T=i(3158),y=i(8780),x=i(5166),I=i(2212),M=i(2569),P=i(3620),D=i(7161),N=i(517),F=i(6610),V=i(6327);const w=["tabGroup"];function G(n,r){1&n&&(t.j41(0,"span",23),t.EFF(1,"\u{1f589}"),t.k0s())}function j(n,r){if(1&n&&(t.EFF(0),t.DNE(1,G,2,0,"span",22)),2&n){const e=t.XpG(2);t.SpI(" ",e.getTabLabel("Package","package").label," "),t.R7$(1),t.Y8G("ngIf",e.getTabLabel("Package","package").modified)}}function B(n,r){if(1&n){const e=t.RV6();t.j41(0,"app-dashboard",24),t.bIt("formModified",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onPackageModified())}),t.k0s()}}function k(n,r){1&n&&(t.j41(0,"mat-tab"),t.DNE(1,j,2,2,"ng-template",10),t.DNE(2,B,1,0,"ng-template",11),t.k0s())}function S(n,r){1&n&&(t.j41(0,"span",23),t.EFF(1,"\u25cf"),t.k0s())}function E(n,r){if(1&n&&(t.EFF(0),t.DNE(1,S,2,0,"span",22)),2&n){const e=t.XpG();t.SpI(" ",e.getTabLabel("Internal Painting","internalPainting").label," "),t.R7$(1),t.Y8G("ngIf",e.getTabLabel("Internal Painting","internalPainting").modified)}}function $(n,r){if(1&n){const e=t.RV6();t.j41(0,"app-requirement",25),t.bIt("formModified",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.onTabModified("internalPainting"))}),t.k0s()}}function L(n,r){1&n&&t.nrm(0,"app-wallpaper",26)}function O(n,r){1&n&&t.nrm(0,"app-texture-painting",27)}function A(n,r){1&n&&t.nrm(0,"app-paneling",28)}function R(n,r){1&n&&t.nrm(0,"app-curtains",29)}function X(n,r){1&n&&t.nrm(0,"app-furniture",30)}function U(n,r){1&n&&t.nrm(0,"app-services",31)}function Q(n,r){1&n&&t.nrm(0,"app-door-grills",32)}function Y(n,r){1&n&&t.nrm(0,"app-additionals",33)}function H(n,r){1&n&&t.nrm(0,"app-summary",34)}function K(n,r){1&n&&t.nrm(0,"app-note",35)}const z=[{path:"",component:(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-quotation-builder"]],decls:1,vars:0,template:function(o,a){1&o&&t.nrm(0,"router-outlet")},dependencies:[u.n3]})}}return n})(),children:[{path:"view/:customerId",component:(()=>{class n{handleKeyDown(e){if("d"===e.key.toLowerCase()&&e.shiftKey){e.preventDefault();const o=this.getTabIndex("summary");-1!==o&&this.navigateToTab(o)}else if("n"===e.key.toLowerCase()&&e.shiftKey){e.preventDefault();const o=this.getTabIndex("note");-1!==o&&this.navigateToTab(o)}}getTabIndex(e){if("summary"===e)return this.ALL_TABS.filter(s=>this.isTabVisible(s)).indexOf("summary");let o=0;for(const a of this.ALL_TABS){if(a===e)return o;this.isTabVisible(a)&&o++}return-1}isTabVisible(e){return"package"!==e||this.showPackageTab}constructor(e,o,a,s,m,ct){this.route=e,this.customerProvider=o,this.formBuilder=a,this.location=s,this.router=m,this.navigationService=ct,this.customerName="Loading...",this.customerId=null,this.activeTabIndex=0,this.isFormModified=!1,this.currentCustomer=null,this.showPackageTab=!1,this.destroy$=new g.B,this.showSummaryTab={Summary:!0},this.showNoteTab={Note:!0},this.ALL_TABS=["package","internalPainting","wallpaper","texturePainting","paneling","curtains","furniture","services","doorGrills","additional","summary","note"],this.tabModifications={package:!1,internalPainting:!1,wallpaper:!1,texturePainting:!1,paneling:!1,curtains:!1,furniture:!1,services:!1,doorGrills:!1,additional:!1,summary:!1,note:!1},this.initializeForm()}initializeForm(){this.quotationForm=this.formBuilder.group({package:this.formBuilder.array([]),internalPainting:this.formBuilder.group({}),wallpaper:this.formBuilder.group({}),texturePainting:this.formBuilder.group({}),paneling:this.formBuilder.group({}),curtains:this.formBuilder.group({}),furniture:this.formBuilder.group({}),services:this.formBuilder.group({}),doorGrills:this.formBuilder.group({}),note:this.formBuilder.group({}),additional:this.formBuilder.group({}),summary:this.formBuilder.group({})}),this.quotationForm.valueChanges.subscribe(()=>{this.isFormModified=!0})}ngOnInit(){this.route.params.pipe((0,f.Q)(this.destroy$)).subscribe(e=>{const o=e.customerId;o&&(this.customerId=Number(o),this.loadCustomerData(this.customerId))}),this.customerProvider.currentCustomer$.pipe((0,f.Q)(this.destroy$)).subscribe(e=>{e&&(this.currentCustomer=e,this.customerName=e.name,this.showPackageTab="Apartment"===e.projectType)})}loadCustomerData(e){const o=this.customerProvider.getCustomerByIdFromState(e);o&&(this.currentCustomer=o,this.customerName=o.name,this.showPackageTab="Apartment"===o.projectType),this.customerProvider.getCustomerById(e).subscribe({next:a=>{a&&(this.currentCustomer=a,this.customerName=a.name,this.showPackageTab="Apartment"===a.projectType)},error:a=>{console.error("Error loading customer:",a),this.currentCustomer||(this.customerName="Unknown Customer",this.showPackageTab=!1)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}navigateToTab(e){this.activeTabIndex=e,setTimeout(()=>{this.tabGroup.selectedIndex=e,this.tabGroup._tabs.forEach(o=>{o.position===e&&(o.isActive=!0)})})}navigateToProduct(){window.open("/product/product","_blank")}onTabChange(e){this.activeTabIndex=e.index}onPackageModified(){this.isFormModified=!0,this.tabModifications.package=!0}onTabModified(e){this.isFormModified=!0,this.tabModifications[e]=!0}toggleSummaryVisibility(e){this.showSummaryTab[e]=!this.showSummaryTab[e]}toggleNoteVisibility(e){this.showNoteTab[e]=!this.showNoteTab[e]}navigateToDashboard(){null!==this.customerId?(this.navigationService.setCustomerId(this.customerId.toString()),this.router.navigate(["/dashboard/dashboard"])):console.error("Customer ID is null")}generateScopeDoc(){console.log("Generating Scope Document..."),Object.keys(this.tabModifications).forEach(e=>{this.tabModifications[e]=!1}),this.isFormModified=!1}getTabLabel(e,o){return{label:e,modified:this.tabModifications[o]}}get package(){return this.quotationForm.get("package")}handleFormChange(){this.isFormModified=!0}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(u.nX),t.rXU(h.y),t.rXU(l.ok),t.rXU(d.aZ),t.rXU(u.Ix),t.rXU(b.o))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-view"]],viewQuery:function(o,a){if(1&o&&t.GBs(w,5),2&o){let s;t.mGM(s=t.lsd())&&(a.tabGroup=s.first)}},hostBindings:function(o,a){1&o&&t.bIt("keydown",function(m){return a.handleKeyDown(m)},!1,t.tSv)},decls:35,vars:5,consts:[[1,"quotation-builder-container"],[1,"header"],[1,"back"],["src","/assets/dashboard.png","title","Dashboard",3,"click"],["src","/assets/catalogue.png","title","Product Catalogue",3,"click"],["src","/assets/left.png","title","Back","routerLink","/customer/view"],[3,"formGroup"],[3,"selectedIndex","preserveContent","selectedIndexChange"],["tabGroup",""],[4,"ngIf"],["mat-tab-label",""],["matTabContent",""],["label","Wallpaper"],["label","Texture Painting"],["label","Paneling"],["label","Curtains"],["label","Furniture"],["label","Services"],["label","Doors & Grills"],["label","Additional"],["label","Summary"],["label","Note"],["class","modified-indicator",4,"ngIf"],[1,"modified-indicator"],["formGroupName","package",3,"formModified"],["formGroupName","internalPainting",3,"formModified"],["formGroupName","wallpaper"],["formGroupName","texturePainting"],["formGroupName","paneling"],["formGroupName","curtains"],["formGroupName","furniture"],["formGroupName","services"],["formGroupName","doorGrills"],["formGroupName","additional"],["formControlName","summary"],["formGroupName","note"]],template:function(o,a){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"div",2)(5,"img",3),t.bIt("click",function(){return a.navigateToDashboard()}),t.k0s(),t.j41(6,"img",4),t.bIt("click",function(){return a.navigateToProduct()}),t.k0s(),t.nrm(7,"img",5),t.k0s()(),t.j41(8,"form",6)(9,"mat-tab-group",7,8),t.bIt("selectedIndexChange",function(m){return a.activeTabIndex=m})("selectedIndexChange",function(m){return a.onTabChange(m)}),t.DNE(11,k,3,0,"mat-tab",9),t.j41(12,"mat-tab"),t.DNE(13,E,2,2,"ng-template",10),t.DNE(14,$,1,0,"ng-template",11),t.k0s(),t.j41(15,"mat-tab",12),t.DNE(16,L,1,0,"ng-template",11),t.k0s(),t.j41(17,"mat-tab",13),t.DNE(18,O,1,0,"ng-template",11),t.k0s(),t.j41(19,"mat-tab",14),t.DNE(20,A,1,0,"ng-template",11),t.k0s(),t.j41(21,"mat-tab",15),t.DNE(22,R,1,0,"ng-template",11),t.k0s(),t.j41(23,"mat-tab",16),t.DNE(24,X,1,0,"ng-template",11),t.k0s(),t.j41(25,"mat-tab",17),t.DNE(26,U,1,0,"ng-template",11),t.k0s(),t.j41(27,"mat-tab",18),t.DNE(28,Q,1,0,"ng-template",11),t.k0s(),t.j41(29,"mat-tab",19),t.DNE(30,Y,1,0,"ng-template",11),t.k0s(),t.j41(31,"mat-tab",20),t.DNE(32,H,1,0,"ng-template",11),t.k0s(),t.j41(33,"mat-tab",21),t.DNE(34,K,1,0,"ng-template",11),t.k0s()()()()),2&o&&(t.R7$(3),t.SpI("Quotation Builder - Customer Name: ",a.customerName,""),t.R7$(5),t.Y8G("formGroup",a.quotationForm),t.R7$(1),t.Y8G("selectedIndex",a.activeTabIndex)("preserveContent",!0),t.R7$(2),t.Y8G("ngIf",a.showPackageTab))},dependencies:[d.bT,u.Wk,l.qT,l.BC,l.cb,l.j4,l.JD,l.$R,p.$L,p.ES,p.mq,p.T8,v.J,C.f,T.s,y.u,x.r,I.U,M.K,P.j,D._,N.S,F.w,V.o],styles:[".quotation-builder-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-left:auto}.back[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:45px;height:45px;background-size:cover}.back[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:45px;display:flex;align-items:center}.actions[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:flex-end}.generate-scope-doc-btn[_ngcontent-%COMP%]{color:#fff;border:none;padding:10px;margin-top:20px;cursor:pointer}.generate-scope-doc-btn[_ngcontent-%COMP%]:hover{opacity:.9}.modified-indicator[_ngcontent-%COMP%]{color:#f44;font-size:18px;margin-left:5px;display:inline-block}  .mat-tab-label{height:auto!important;padding:12px 24px!important}  .mat-tab-label-content{display:flex!important;align-items:center!important}"]})}}return n})()},{path:"view",redirectTo:"",pathMatch:"full"}]}];let W=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[u.iI.forChild(z),u.iI]})}}return n})();var J=i(737),Z=i(1683),_=i(2931),q=i(3152),tt=i(3321),et=i(3508),nt=i(3554),ot=i(4280),it=i(1718),at=i(1084),rt=i(2059),st=i(5310),lt=i(4412);let mt=(()=>{class n{constructor(){this.dirtyFormsCount=0,this.formDirtyState=new lt.t(!1),this.formDirty$=this.formDirtyState.asObservable()}setFormDirty(e){e?this.dirtyFormsCount++:this.dirtyFormsCount=Math.max(0,this.dirtyFormsCount-1),this.formDirtyState.next(this.dirtyFormsCount>0)}resetAllForms(){this.dirtyFormsCount=0,this.formDirtyState.next(!1)}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ut=i(8834),pt=i(3872);let dt=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({providers:[mt],imports:[d.MD,W,l.X1,p.RI,J.InternalPaintingModule,Z.RequiremetnModule,_.TexturePaintingModule,l.YN,at.WallpaperModule,q.PanelingModule,tt.CurtainsModule,et.FurnitureModule,nt.ServicesModule,ot.DoorGrillsModule,it.NoteModule,rt.PackageModule,st.SummaryModule,ut.Hl,pt.AdditionalsModule]})}}return n})()}}]);